% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pgsa.R
\name{PGSA}
\alias{PGSA}
\title{Pathway Gene Set Analysis (PGSA)}
\usage{
PGSA(exprs, group, genesets, iter = 20, ncore = 1, minSize = 5, ...)
}
\arguments{
\item{exprs}{A numeric matrix or data frame containing expression values.
Rows represent genes/features and columns represent samples.}

\item{group}{A named factor or character vector specifying the experimental
groups for each sample. Names should correspond to column names in exprs.
Must contain exactly two unique values.}

\item{genesets}{A named list where each element contains gene identifiers
belonging to a pathway/gene set. Names will be used as pathway identifiers
in the results.}

\item{iter}{Integer specifying the number of perturbation iterations to
perform. Default is 20. Higher values increase accuracy but computation time.}

\item{ncore}{Integer specifying the number of CPU cores to use for parallel
processing. Default is 1. Uses parallel processing that works on all platforms
including Windows.}

\item{minSize}{Integer specifying the minimum number of genes required in a
gene set for analysis. Gene sets smaller than this will be excluded.
Default is 5.}

\item{...}{Additional arguments (currently unused, maintained for compatibility).}
}
\value{
A data frame with the following columns:
\describe{
\item{pathway}{Character vector of pathway/gene set names}
\item{p.value}{Numeric vector of adjusted p-values for pathway enrichment}
}
Pathways are ordered by significance (lowest p-values first).
}
\description{
Performs gene set enrihment analysis using perturbation-based approach
with K-means clustering and differential expression analysis. This method
accounts for pathway co-regulation and provides robust statistical inference.
}
\details{
The PGSA method performs the following steps:
\enumerate{
\item Computes a distance matrix using PCA on expression data
\item Generates null distribution through permutation testing
\item Performs iterative perturbation of expression data
\item Uses K-means clustering to identify stable sample groups
\item Conducts differential expression analysis on each perturbation
\item Applies Wilcoxon rank-sum tests for pathway enrichment
\item Adjusts final p-values using regression-based calibration
}

The method is designed to be robust to noise and provides conservative
statistical inference by accounting for pathway interdependencies.
}
\examples{
# Example 1: Basic PGSA analysis
set.seed(123)

# Create example expression data
exprs_data <- matrix(rnorm(2000 * 20, mean = 10, sd = 2),
                     nrow = 2000, ncol = 20)
rownames(exprs_data) <- paste0("Gene_", 1:2000)
colnames(exprs_data) <- paste0("Sample_", 1:20)

# Create group labels
group_labels <- factor(rep(c("c", "d"), each = 10))
names(group_labels) <- colnames(exprs_data)

# Create example gene sets
gene_sets <- list(
  "Pathway_A" = paste0("Gene_", 1:50),
  "Pathway_B" = paste0("Gene_", 51:100),
  "Pathway_C" = paste0("Gene_", 101:150)
)

# Run PGSA analysis
results <- PGSA(exprs = exprs_data,
                group = group_labels,
                genesets = gene_sets,
                iter = 10,  # Reduced for example
                ncore = 1)

print(results)

# Example 2: Multi-core analysis (if multiple cores available)
results_parallel <- PGSA(exprs = exprs_data,
                         group = group_labels,
                         genesets = gene_sets,
                         iter = 100,
                         ncore = 2)  # Use 2 cores

}
\seealso{
\code{\link[stats]{kmeans}}, \code{\link[stats]{wilcox.test}},
\code{\link{runLimma}}
}
